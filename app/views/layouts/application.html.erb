<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <%= csrf_meta_tags %>
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <script src="https://use.fontawesome.com/297cffcc6b.js"></script>
        <link href="https://fonts.googleapis.com/css?family=PT+Serif:400,400i,700,700i" rel="stylesheet">
        <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
        <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
    </head>

    <body>
        <%= render 'shared/header' %>
        <% if notice or alert %>
        <div class="container absolute no-display marg-top-25" id="alert-container">
            <div class="row">
                <div class="col-12 col-md-10 offset-md-1 col-lg-6 offset-lg-3">
                    <% if notice %>
                    <div class="alert alert-info" role="alert">
                        <p class="notice"><%=notice%></p>
                    </div>
                    <% end %>
                    <% if alert %>
                    <div class="alert alert-danger" role="alert">
                        <p class="alert"><%=alert%></p>
                    </div>
                    <% end %>
                </div>
            </div>
        </div>
        <% end %>

        <div class="page-content">
            <%= yield %>
        </div>

        <%= render 'shared/footer' %>

        <!-- smoothscroll: https://stackoverflow.com/questions/4198041/jquery-smooth-scroll-to-an-anchor -->
        <script>
            $(".scroll").click(function (event) {
                event.preventDefault();
                //calculate destination place
                var dest = 0;
                if ($(this.hash).offset().top > $(document).height() - $(window).height()) {
                    dest = $(document).height() - $(window).height();
                } else {
                    dest = $(this.hash).offset().top - 50;
                }
                //go to destination
                $('html,body').animate({
                    scrollTop: dest
                }, 500, 'swing');
            });

            function positionBack() {
                var bot = $(window).scrollTop() + $(window).height();
                var foot = $('footer').offset().top;
                if (bot >= foot) {
                    $('#back').removeClass('back-to-top-fixed');
                    $('#back').addClass('back-to-top-absolute');
                } else {
                    $('#back').addClass('back-to-top-fixed');
                    $('#back').removeClass('back-to-top-absolute');
                }
            }

            $(window).scroll(function () {
                positionBack();
            });
            $(window).resize(function () {
                positionBack();
            });
        </script>

        <% if notice or alert %>
        <script>
            $(document).ready(function () {
                $('#alert-container').delay(200).slideDown(200).delay(1600).slideUp(200);
            });
        </script>
        <% end %>

        <% if Rails.env.production? %>
        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r;
                i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                },
                i[r].l = 1 * new Date();
                a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
                a.async = 1;
                a.src = g;
                m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-90344765-1', 'auto');
            ga('send', 'pageview');
        </script>
        <% end %>
    </body>
</html>
